<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚»ãƒ«ãƒ•ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .lang-selector { display: flex; justify-content: center; gap: 10px; padding: 20px; background: #f8f9fa; flex-wrap: wrap; }
        .lang-btn { padding: 10px 15px; border: 2px solid #ddd; background: white; border-radius: 10px; cursor: pointer; }
        .lang-btn.active { background: #667eea; color: white; border-color: #667eea; }
        .content { padding: 30px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; }
        input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; }
        .btn-group { display: flex; gap: 10px; margin-top: 30px; }
        button { flex: 1; padding: 15px; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #667eea; color: white; }
        .btn-secondary { background: #f0f0f0; color: #333; }
        .btn-success { background: #27ae60; color: white; }
        .hidden { display: none; }
        .step-indicator { display: flex; justify-content: space-between; margin-bottom: 20px; }
        .step { width: 30px; height: 30px; border-radius: 50%; background: #eee; text-align: center; line-height: 30px; }
        .step.active { background: #667eea; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="title">Check-in</h1>
            <p id="subtitle">Welcome!</p>
        </div>

        <div class="lang-selector">
            <button class="lang-btn active" onclick="changeLanguage('ja', this)">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</button>
            <button class="lang-btn" onclick="changeLanguage('en', this)">ğŸ‡¬ğŸ‡§ English</button>
        </div>

        <div class="content" id="mainContent">
            <div class="step-indicator">
                <div class="step active" id="step1">1</div>
                <div class="step" id="step2">2</div>
                <div class="step" id="step3">3</div>
            </div>

            <form id="checkinForm">
                <div id="stepContent1">
                    <div class="form-group"><label id="labelName">ãŠåå‰ / Name</label><input type="text" id="name" placeholder="Taro Yamada"></div>
                    <div class="form-group"><label id="labelNationality">å›½ç± / Nationality</label><input type="text" id="nationality" placeholder="Japan"></div>
                </div>

                <div id="stepContent2" class="hidden">
                    <div class="form-group"><label id="labelPhone">é›»è©±ç•ªå· / Phone</label><input type="tel" id="phone" placeholder="090-0000-0000"></div>
                    <div class="form-group"><label id="labelAddress">ä½æ‰€ / Address</label><input type="text" id="address" placeholder="Tokyo..."></div>
                </div>

                <div id="stepContent3" class="hidden">
                    <p style="text-align: center; padding: 20px;">Ready to complete?</p>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn-secondary hidden" id="backBtn" onclick="previousStep()">Back</button>
                    <button type="button" class="btn-primary" id="nextBtn" onclick="nextStep()">Next</button>
                    <button type="button" class="btn-success hidden" id="submitBtn" onclick="submitForm()">Complete</button>
                </div>
            </form>
        </div>
        <div class="success-screen hidden" id="successScreen" style="padding:50px; text-align:center;">
            <h2>Redirecting...</h2>
            <p>Moving to PIN page...</p>
        </div>
    </div>

    <script>
        // --- è¨­å®šç®‡æ‰€ ---
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbxXCGLueSM9KbpiFpLKYGfC7zAoYcVQuu9TtAwvWyEhjH7faMZNf45y2ZOvxgIGvQG0/exec';
        const STEP2_URL = 'https://script.google.com/macros/s/AKfycbw8ICsKHFHO99zSMplJxtlROmvoYI_bF2-H-QCZ2T1kG39COhN5dFPZRytVap0YdN7GJA/exec';

        let currentStep = 1;

        function updateStepDisplay() {
            document.getElementById('stepContent1').classList.toggle('hidden', currentStep !== 1);
            document.getElementById('stepContent2').classList.toggle('hidden', currentStep !== 2);
            document.getElementById('stepContent3').classList.toggle('hidden', currentStep !== 3);
            
            document.getElementById('step1').classList.toggle('active', currentStep >= 1);
            document.getElementById('step2').classList.toggle('active', currentStep >= 2);
            document.getElementById('step3').classList.toggle('active', currentStep >= 3);

            document.getElementById('backBtn').classList.toggle('hidden', currentStep === 1);
            document.getElementById('nextBtn').classList.toggle('hidden', currentStep === 3);
            document.getElementById('submitBtn').classList.toggle('hidden', currentStep !== 3);
        }

        function nextStep() { currentStep++; updateStepDisplay(); }
        function previousStep() { currentStep--; updateStepDisplay(); }

        async function submitForm() {
            const btn = document.getElementById('submitBtn');
            const guestName = document.getElementById('name').value;
            btn.disabled = true;
            btn.innerText = 'Sending...';

            const data = {
                name: guestName,
                nationality: document.getElementById('nationality').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value
            };

            try {
                // Step 1: ä¿å­˜
                await fetch(GAS_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) });

                document.getElementById('mainContent').classList.add('hidden');
                document.getElementById('successScreen').classList.remove('hidden');

                // Step 2: æš—è¨¼ç•ªå·ç”»é¢ã¸ã‚¸ãƒ£ãƒ³ãƒ—ï¼ˆåå‰ä»˜ãï¼‰
                setTimeout(() => {
                    window.location.href = STEP2_URL + '?name=' + encodeURIComponent(guestName);
                }, 1000);

            } catch (e) {
                alert('Error!');
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
